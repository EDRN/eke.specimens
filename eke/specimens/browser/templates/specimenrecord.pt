<html xmlns='http://www.w3.org/1999/xhtml'
    xml:lang='en'
    lang='en'
    xmlns:tal='http://xml.zope.org/namespaces/tal'
    xmlns:metal='http://xml.zope.org/namespaces/metal'
    xmlns:i18n='http://xml.zope.org/namespaces/i18n'
    metal:use-macro='context/main_template/macros/master'
    i18n:domain='eke.specimens'>
    <head>
        <title>Specimen Record</title>
    </head>
    <body>
        <metal:css fill-slot='style_slot'>
            <style type='text/css' media='all' tal:content='string:@import url(${context/++resource++specimen.css});'></style>
        </metal:css>
        <metal:main fill-slot='main'>
            <tal:main-macro metal:define-macro='main' tal:define='specimens view/specimens'>
                <div tal:replace='structure provider:plone.abovecontenttitle' />
                <h1 class='documentFirstHeading'> 
                    <metal:field use-macro='python:context.widget("title", mode="view")'>
                        Title
                    </metal:field>
                </h1>

                <div tal:replace='structure provider:plone.belowcontenttitle' />
                <!-- No "description" field for objects of this class -->
                <div tal:replace='structure provider:plone.abovecontentbody' />
            
                <table class='summaryData'>
                    <thead>
                        <tr>
                            <th colspan='2' i18n:translate='th_collectionSummary'>Collection Summary</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td i18n:translate='label_specimenCount'>Specimen Count:</td>
                            <td class='specimenStat' tal:content='context/specimenCount'>3</td></tr>
                        <tr>
                            <td i18n:translate='label_participantCount'>Participants:</td>
                            <td class='specimenStat' tal:content='context/participantCount'>5</td></tr>
                        <tr>
                            <td i18n:translate='label_diagnosis'>Diagnosis:</td>
                            <td class='specimenStat' >
                                <metal:field use-macro='python:context.widget("cancerDiagnosis", mode="view")'>X</metal:field>
                            </td>
                        </tr>
                        <tr>
                            <td i18n:translate='label_specimenType'>Specimen Type:</td>
                            <td class='specimenStat'>
                                <metal:field use-macro='python:context.widget("specimenType", mode="view")'>Goo</metal:field>
                            </td>
                        </tr>
                        <tr>
                            <td i18n:translate='label_storageType'>Storage Type:</td>
                            <td class='specimenStat'>
                                <metal:field use-macro='python:context.widget("storageType", mode="view")'>Fridge</metal:field>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <p class='discreet' tal:condition='not:specimens' i18n:translate='edrnDown'>
                    The EDRN Resource Network Exchange (ERNE) is unable to provide details on
                    the specimens in this collection at this time.
                </p>

                <div tal:condition='specimens'>
                    <h2 i18n:translate='heading_Specimens'>Specimens</h2>
                    <p i18n:translate='sharingOfSpecimens'>
                        To obtain these specimens for your own analysis, please contact
                        <a href='mailto:#' tal:attributes='href string:mailto:${specimens/contact}'
                            tal:content='specimens/contact'>Joe</a>.
                    </p>
                    <table tal:condition='specimens' class='listing specimenData'>
                        <thead>
                            <tr>
                                <th i18n:translate='th_pptID'>Participant ID</th>
                                <th i18n:translate='th_icd9'>ICD9</th>
                                <th i18n:translate='th_gender'>Gender</th>
                                <th i18n:translate='th_race'>Race</th>
                                <th i18n:translate='th_ethnicity'>Ethnicity</th>
                                <th i18n:translate='th_ages'>Ages&#x00b9;</th>
                                <th i18n:translate='th_amounts'>Amounts&#x00b2;</th>
                                <th i18n:translate='th_final'>Final Storage</th>
                                <th i18n:translate='th_available'>Available?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tal:block repeat='specimen specimens'>
                                <tr tal:define='oddrow repeat/specimen/odd'
                                    tal:attributes='class python:oddrow and "odd" or "even"'>
                                    <td tal:content='specimen/pptID'>12345-67-A</td>
                                    <td tal:content='specimen/icd9'>123.4</td>
                                    <td tal:define='gender specimen/gender'>
                                        <span class='femPPT' tal:condition='python:gender == "Female"'>&#x2640;</span>
                                        <span class='malePPT' tal:condition='python:gender == "Male"'>&#x2642;</span>
                                        <span tal:condition='python:gender not in ("Female", "Male")' tal:replace='gender'>
                                            Shemale
                                        </span>
                                    </td>
                                    <td tal:content='specimen/race'>Orc</td>
                                    <td tal:content='specimen/ethnicity'>Uncorrupted (brownskin) orc</td>
                                    <td>
                                        <span tal:replace='specimen/ageAtDX'>9</span>/<span
                                            tal:replace='specimen/ageAtCollection'>23</span>
                                    </td>
                                    <td>
                                        <span tal:replace='specimen/collected'>32</span>/<span
                                            tal:replace='specimen/remaining'>31</span>
                                    </td>
                                    <td tal:content='python:view.getStorageFor(specimen.final)'>On ice</td>
                                    <td tal:define='available python:specimen.isAvailable == "1"'>
                                        <span class='specimenAvailable' tal:condition='available'>&#x2713;</span>
                                    </td>
                                </tr>
                            </tal:block>
                        </tbody>
                    </table>
                    <p class='discreet' tal:condition='python:specimens.count &gt; specimens.limit' i18n:translate='moreSpecimens'>
                        There are <span i18n:name='total' tal:replace='specimens/count'>2132</span> specimens
                        matching these criteria; only the first <span i18n:name='limit' tal:replace='specimens/limit'>100</span>
                        are shown.
                    </p>
                    <p class='discreet' tal:condition='python:specimens.count &lt;= specimens.limit and specimens.count &gt; 1'
                        i18n:translate='allSpecimens'>
                        All <span i18n:name='total' tal:replace='specimens/count'>100</span> specimens matching these
                        criteria shown. 
                    </p>
                    <p class='discreet' tal:condition='python:specimens.count == 1' i18n:translate='oneSpecimen'>
                        Only one specimen matches these criteria.
                    </p>
                    <h3 i18n:translate='h3_notes'>Notes</h3>
                    <p i18n:translate='agesNote'>&#x00b9;Ages are shown as age at diagnosis/age at collection.</p>
                    <p i18n:translate='amountsNote'>&#x00b2;Amounts are shown as originally collected/amount remaining.</p>
                </div>
                <div metal:use-macro='context/document_relateditems/macros/relatedItems'>
                    Any related items
                </div>
                <div tal:replace='structure provider:plone.belowcontentbody' />
            </tal:main-macro>
        </metal:main>
    </body>
</html>
